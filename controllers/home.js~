/**
 * GET /
 * Home page.
 */

exports.index = function(req, res) {
    var Linkedin = require('node-linkedin')('api', 'secret', 'callback');
	var linkedin = Linkedin.init('my_access_token');

	app.get('/oauth/linkedin', function(req, res) {
		// This will ask for permisssions etc and redirect to callback url.
		Linkedin.auth.authorize(res, ['r_basicprofile', 'r_fullprofile', 'r_emailaddress', 'r_network', 'r_contactinfo', 'rw_nus', 'rw_groups', 'w_messages']);
	});

	app.get('/oauth/linkedin/callback', function(req, res) {
		Linkedin.auth.getAccessToken(res, req.query.code, function(err, results) {
		    if ( err )
		        return console.error(err);

		    /**
		     * Results have something like:
		     * {"expires_in":5184000,"access_token":". . . ."}
		     */

		    console.log(results);
		    return res.redirect('/');
		});
	});
    res.json({message:"HelloWorld"});

};
